import React, { useState, useEffect, useRef } from 'react';
import { Phone, Map, MessageCircle, Globe, User, Search, Bell, X } from 'lucide-react';

const TourPassApp = () => {
  const [mode, setMode] = useState('basic');
  const [timeRemaining, setTimeRemaining] = useState(24 * 60 * 60);
  const [showScanner, setShowScanner] = useState(false);
  const [showResult, setShowResult] = useState(false);
  const [scanResult, setScanResult] = useState(null);
  const [showDetail, setShowDetail] = useState(null);
  const [adultCount, setAdultCount] = useState(2);
  const [childCount, setChildCount] = useState(1);
  const [favorites, setFavorites] = useState(new Set(['palace', 'cafe']));
  const [language, setLanguage] = useState('ko');
  const [showPopup, setShowPopup] = useState(true);
  const [hidePopupToday, setHidePopupToday] = useState(false);
  const [aiRecommendation, setAiRecommendation] = useState(null);
  const [userAnswers, setUserAnswers] = useState({});
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [isAnalyzing, setIsAnalyzing] = useState(false);
  const [currentBanner, setCurrentBanner] = useState(0);
  const [showSurvey, setShowSurvey] = useState(false);
  const [surveyStep, setSurveyStep] = useState(0);
  const [surveyAnswers, setSurveyAnswers] = useState({});
  
  const videoRef = useRef(null);
  const streamRef = useRef(null);

  const bannerAds = [
    {
      id: 1,
      title: 'ğŸ“Š ë§Œì¡±ë„ ì¡°ì‚¬',
      subtitle: 'íˆ¬ì–´íŒ¨ìŠ¤ ì´ìš© í›„ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”!',
      bgColor: 'from-indigo-500 to-purple-600',
      textColor: 'text-white',
      type: 'survey'
    },
    {
      id: 2,
      title: 'ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¹ê°€',
      subtitle: '12ì›” í•œì •! íˆ¬ì–´íŒ¨ìŠ¤ 30% í• ì¸',
      bgColor: 'from-red-500 to-green-600',
      textColor: 'text-white',
      type: 'promotion'
    },
    {
      id: 3,
      title: 'ğŸ• ë§›ì§‘ íˆ¬ì–´',
      subtitle: 'ì„œìš¸ í•«í”Œë ˆì´ìŠ¤ ë§›ì§‘ íŠ¹ë³„ê°€',
      bgColor: 'from-orange-400 to-yellow-500',
      textColor: 'text-white',
      type: 'promotion'
    },
    {
      id: 4,
      title: 'ğŸ¨ ì²´í—˜ í”„ë¡œê·¸ë¨',
      subtitle: 'ì „í†µê³µì˜ˆ ì²´í—˜ + ê¸°ë…í’ˆ ì¦ì •',
      bgColor: 'from-purple-500 to-pink-600',
      textColor: 'text-white',
      type: 'promotion'
    },
    {
      id: 5,
      title: 'ğŸ“± ì•± ì „ìš©',
      subtitle: 'ëª¨ë°”ì¼ ì˜ˆì•½ì‹œ ì¶”ê°€ 10% í• ì¸',
      bgColor: 'from-blue-500 to-cyan-600',
      textColor: 'text-white',
      type: 'promotion'
    }
  ];

  const statsData = {
    topDestinations: [
      { name: 'ë•ìˆ˜ê¶', percentage: 38, type: 'palace' },
      { name: 'í—¤ì´í‹°', percentage: 28, type: 'cafe' },
      { name: 'ì›ƒëŠ”ë‚ ê³µë°©', percentage: 22, type: 'workshop' }
    ]
  };

  const questionData = [
    {
      id: 'travelStyle',
      question: 'ì–´ë–¤ ì—¬í–‰ ìŠ¤íƒ€ì¼ì„ ì„ í˜¸í•˜ì‹œë‚˜ìš”?',
      options: ['ëŠê¸‹í•œ ê´€ê´‘', 'ì²´í—˜ ì¤‘ì‹¬', 'ì‚¬ì§„ ì´¬ì˜', 'ë¬¸í™” íƒë°©']
    },
    {
      id: 'groupType',
      question: 'ëˆ„êµ¬ì™€ í•¨ê»˜ ì—¬í–‰í•˜ì‹œë‚˜ìš”?',
      options: ['í˜¼ì', 'ì—°ì¸/ì¹œêµ¬', 'ê°€ì¡±(ì•„ì´ ë™ë°˜)', 'ê°€ì¡±(ì„±ì¸ë§Œ)']
    },
    {
      id: 'timeAvailable',
      question: 'ì´ìš© ê°€ëŠ¥í•œ ì‹œê°„ì€ ì–¼ë§ˆë‚˜ ë˜ë‚˜ìš”?',
      options: ['2-3ì‹œê°„', 'ë°˜ë‚˜ì ˆ (4-5ì‹œê°„)', 'ì¢…ì¼ (6ì‹œê°„ ì´ìƒ)', 'ì‹œê°„ ì—¬ìœ  ì¶©ë¶„']
    },
    {
      id: 'interests',
      question: 'ê°€ì¥ ê´€ì‹¬ ìˆëŠ” í™œë™ì€?',
      options: ['ì—­ì‚¬/ë¬¸í™”ì¬', 'ì¹´í˜/ë§›ì§‘', 'ì²´í—˜ í™œë™', 'ì‡¼í•‘']
    }
  ];

  const surveyQuestions = [
    {
      id: 'satisfaction',
      question: 'íˆ¬ì–´íŒ¨ìŠ¤ ì„œë¹„ìŠ¤ì— ì–¼ë§ˆë‚˜ ë§Œì¡±í•˜ì‹œë‚˜ìš”?',
      type: 'rating',
      options: [
        { value: 5, label: 'ë§¤ìš° ë§Œì¡±', emoji: 'ğŸ˜' },
        { value: 4, label: 'ë§Œì¡±', emoji: 'ğŸ˜Š' },
        { value: 3, label: 'ë³´í†µ', emoji: 'ğŸ˜' },
        { value: 2, label: 'ë¶ˆë§Œì¡±', emoji: 'ğŸ˜' },
        { value: 1, label: 'ë§¤ìš° ë¶ˆë§Œì¡±', emoji: 'ğŸ˜¡' }
      ]
    },
    {
      id: 'recommendation',
      question: 'ì¹œêµ¬ë‚˜ ê°€ì¡±ì—ê²Œ ì¶”ì²œí•˜ì‹œê² ì–´ìš”?',
      type: 'choice',
      options: [
        { value: 'yes', label: 'ë„¤, ê¼­ ì¶”ì²œí•˜ê² ì–´ìš”' },
        { value: 'maybe', label: 'ìƒí™©ì— ë”°ë¼ ì¶”ì²œí•  ê²ƒ ê°™ì•„ìš”' },
        { value: 'no', label: 'ì¶”ì²œí•˜ì§€ ì•Šì„ ê²ƒ ê°™ì•„ìš”' }
      ]
    },
    {
      id: 'improvement',
      question: 'ê°€ì¥ ê°œì„ ì´ í•„ìš”í•œ ë¶€ë¶„ì€?',
      type: 'choice',
      options: [
        { value: 'more_places', label: 'ë” ë§ì€ ê°€ë§¹ì ' },
        { value: 'better_benefits', label: 'ë” ë‚˜ì€ í˜œíƒ' },
        { value: 'easier_use', label: 'ì‚¬ìš©ë²• ê°œì„ ' },
        { value: 'customer_service', label: 'ê³ ê°ì„œë¹„ìŠ¤ ê°œì„ ' }
      ]
    }
  ];

  const handleBannerClick = (banner) => {
    if (banner.type === 'survey') {
      setShowSurvey(true);
      setSurveyStep(0);
    } else {
      // ë‹¤ë¥¸ ë°°ë„ˆë“¤ì€ ê¸°ì¡´ ë™ì‘
      console.log('ë°°ë„ˆ í´ë¦­:', banner.title);
    }
  };

  const handleHidePopupToday = () => {
    setHidePopupToday(true);
    setShowPopup(false);
  };

  useEffect(() => {
    const browserLang = navigator.language || navigator.userLanguage;
    if (browserLang.startsWith('en')) {
      setLanguage('en');
    } else if (browserLang.startsWith('ja')) {
      setLanguage('ja');
    } else if (browserLang.startsWith('zh')) {
      setLanguage('zh');
    } else {
      setLanguage('ko');
    }
  }, []);

  useEffect(() => {
    const bannerTimer = setInterval(() => {
      setCurrentBanner(prev => (prev + 1) % bannerAds.length);
    }, 3000);
    return () => clearInterval(bannerTimer);
  }, []);

  const texts = {
    ko: {
      easyOff: 'ê°„í¸ OFF',
      easyOn: 'ê°„í¸ ON',
      qrAuth: 'QRì¸ì¦',
      searchPlaceholder: 'íˆ¬ì–´íŒ¨ìŠ¤ ì—¬í–‰ì§€ë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”',
      timeRemaining: 'ì‚¬ìš©ê°€ëŠ¥í•œ ë‚¨ì€ ì‹œê°„ì„ í™•ì¸í•˜ì„¸ìš”.',
      myFavorites: 'ë‚˜ë§Œì˜ íˆ¬ì–´íŒ¨ìŠ¤ ë¦¬ìŠ¤íŠ¸',
      freeUse: 'ììœ  ì´ìš©',
      viewFacilities: 'ì´ìš©ê°€ëŠ¥í•œ ì‹œì„¤ë³´ê¸°',
      seeAll: 'ì „ì²´ë³´ê¸° +',
      popularDestinations: 'ì¸ê¸° ê´€ê´‘ì§€ ìˆœìœ„',
      nextDestination: 'ë‹¤ìŒ ì¶”ì²œ ì¥ì†Œ',
      deoksugung: 'ë•ìˆ˜ê¶',
      freeEntry: 'ë¬´ë£Œì…ì¥',
      haity: 'í—¤ì´í‹°',
      drinkService: 'ìŒë£Œì œê³µ',
      laughingDayWorkshop: 'ì›ƒëŠ”ë‚ ê³µë°©',
      travelTopperExperience: 'ì—¬í–‰í† í¼ ì²´í—˜',
      favoritesTitle: 'ë‚´ê°€ ì°œí•œ ê°€ë§¹ì ',
      noFavorites: 'ì°œí•œ ê°€ë§¹ì ì´ ì—†ìŠµë‹ˆë‹¤.\ní•˜íŠ¸ë¥¼ ëˆŒëŸ¬ ê°€ë§¹ì ì„ ì°œí•´ë³´ì„¸ìš”!',
      mobileAuth: 'ëª¨ë°”ì¼ì¸ì¦',
      announcement: 'ê³µì§€',
      chatbot: 'ì±—ë´‡',
      language: 'Language',
      close: 'ë‹«ê¸°',
      confirm: 'í™•ì¸',
      importantNotice: 'ì¤‘ìš” ê³µì§€'
    },
    en: {
      easyOff: 'Simple OFF',
      easyOn: 'Simple ON',
      qrAuth: 'QR Auth',
      searchPlaceholder: 'Search tour pass destinations',
      timeRemaining: 'Check your remaining time.',
      myFavorites: 'My Tour Pass List',
      freeUse: 'Free Access',
      viewFacilities: 'View Available Facilities',
      seeAll: 'See All +',
      popularDestinations: 'Popular Destinations Ranking',
      nextDestination: 'Next Recommended Place',
      deoksugung: 'Deoksugung Palace',
      freeEntry: 'Free Entry',
      haity: 'Haity Cafe',
      drinkService: 'Drink Service',
      laughingDayWorkshop: 'Laughing Day Workshop',
      travelTopperExperience: 'Travel Topper Experience',
      favoritesTitle: 'My Favorite Places',
      noFavorites: 'No favorite places yet.\nTap the heart to add favorites!',
      mobileAuth: 'Mobile Auth',
      announcement: 'Notice',
      chatbot: 'Chatbot',
      language: 'ì–¸ì–´',
      close: 'Close',
      confirm: 'Confirm',
      importantNotice: 'Important Notice'
    }
  };

  const t = texts[language];

  useEffect(() => {
    const timer = setInterval(() => {
      setTimeRemaining(prev => {
        if (prev <= 0) return 0;
        return prev - 1;
      });
    }, 1000);

    return () => clearInterval(timer);
  }, []);

  const generateAIRecommendation = (answers) => {
    const recommendations = {
      cultural: {
        title: 'ë¬¸í™” íƒë°© ì½”ìŠ¤',
        description: 'ì—­ì‚¬ì™€ ì „í†µì„ ì²´í—˜í•˜ëŠ” ê¹Šì´ ìˆëŠ” ì—¬í–‰',
        course: [
          { time: '09:00-10:30', place: 'ë•ìˆ˜ê¶', activity: 'ê¶ê¶ íƒë°© ë° ì—­ì‚¬ í•´ì„¤', duration: '1ì‹œê°„ 30ë¶„' },
          { time: '11:00-11:30', place: 'í—¤ì´í‹°', activity: 'ì „í†µì°¨ì™€ í•¨ê»˜ íœ´ì‹', duration: '30ë¶„' },
          { time: '12:00-13:30', place: 'ì›ƒëŠ”ë‚ ê³µë°©', activity: 'ì „í†µ ê³µì˜ˆ ì²´í—˜', duration: '1ì‹œê°„ 30ë¶„' }
        ],
        tip: 'ë¬¸í™”ì¬ ê´€ëŒ ì‹œ í•´ì„¤ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹œë©´ ë”ìš± ì•Œì°¬ ì‹œê°„ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
      },
      leisure: {
        title: 'ì—¬ìœ ë¡œìš´ íë§ ì½”ìŠ¤',
        description: 'ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ í’€ê³  ì¬ì¶©ì „í•˜ëŠ” í¸ì•ˆí•œ ì—¬í–‰',
        course: [
          { time: '10:00-11:00', place: 'í—¤ì´í‹°', activity: 'ë¸ŒëŸ°ì¹˜ì™€ ìŒë£Œ', duration: '1ì‹œê°„' },
          { time: '11:30-12:30', place: 'ë•ìˆ˜ê¶', activity: 'ì‚°ì±…ê³¼ ì‚¬ì§„ ì´¬ì˜', duration: '1ì‹œê°„' },
          { time: '13:00-14:00', place: 'ì›ƒëŠ”ë‚ ê³µë°©', activity: 'ê°„ë‹¨í•œ ë§Œë“¤ê¸° ì²´í—˜', duration: '1ì‹œê°„' }
        ],
        tip: 'ê° ì¥ì†Œì—ì„œ ì¶©ë¶„í•œ ì‹œê°„ì„ ê°€ì§€ê³  ì—¬ìœ ë¡­ê²Œ ì¦ê¸°ì„¸ìš”.'
      },
      experience: {
        title: 'ì²´í—˜ ì¤‘ì‹¬ ì•¡í‹°ë¸Œ ì½”ìŠ¤',
        description: 'ë‹¤ì–‘í•œ í™œë™ìœ¼ë¡œ íŠ¹ë³„í•œ ì¶”ì–µ ë§Œë“¤ê¸°',
        course: [
          { time: '09:30-10:30', place: 'ì›ƒëŠ”ë‚ ê³µë°©', activity: 'í† í¼ ë§Œë“¤ê¸° ì²´í—˜', duration: '1ì‹œê°„' },
          { time: '11:00-12:00', place: 'ë•ìˆ˜ê¶', activity: 'ì „í†µ ì˜ìƒ ì²´í—˜', duration: '1ì‹œê°„' },
          { time: '12:30-13:00', place: 'í—¤ì´í‹°', activity: 'ë°”ë¦¬ìŠ¤íƒ€ ì²´í—˜', duration: '30ë¶„' }
        ],
        tip: 'ì²´í—˜ í™œë™ì€ ì˜ˆì•½ì´ í•„ìš”í•  ìˆ˜ ìˆìœ¼ë‹ˆ ë¯¸ë¦¬ ë¬¸ì˜í•´ë³´ì„¸ìš”.'
      }
    };

    if (answers.interests === 'ì—­ì‚¬/ë¬¸í™”ì¬' || answers.travelStyle === 'ë¬¸í™” íƒë°©') {
      return recommendations.cultural;
    } else if (answers.travelStyle === 'ëŠê¸‹í•œ ê´€ê´‘' || answers.timeAvailable === 'ì‹œê°„ ì—¬ìœ  ì¶©ë¶„') {
      return recommendations.leisure;
    } else {
      return recommendations.experience;
    }
  };

  const startCamera = async () => {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ 
        video: { facingMode: 'environment' } 
      });
      if (videoRef.current) {
        videoRef.current.srcObject = stream;
        streamRef.current = stream;
      }
      setShowScanner(true);
    } catch (error) {
      console.error('ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨:', error);
      alert('ì¹´ë©”ë¼ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }
  };

  const stopCamera = () => {
    if (streamRef.current) {
      streamRef.current.getTracks().forEach(track => track.stop());
      streamRef.current = null;
    }
    setShowScanner(false);
  };

  const simulateQRScan = () => {
    setTimeout(() => {
      const mockResults = [
        {
          time: new Date().toLocaleString('ko-KR'),
          benefit: 'ì•„ë©”ë¦¬ì¹´ë…¸ 1ì” ë¬´ë£Œ',
          notice: '1ì¸ 1íšŒ ì œê³µ, ë‹¹ì¼ ìœ íš¨'
        },
        {
          time: new Date().toLocaleString('ko-KR'),
          benefit: 'ì…ì¥ë£Œ 20% í• ì¸',
          notice: 'ë‹¤ë¥¸ í• ì¸ê³¼ ì¤‘ë³µ ë¶ˆê°€'
        }
      ];
      
      const randomResult = mockResults[Math.floor(Math.random() * mockResults.length)];
      setScanResult(randomResult);
      stopCamera();
      setShowResult(true);
    }, 2000);
  };

  useEffect(() => {
    if (showScanner && videoRef.current) {
      simulateQRScan();
    }
  }, [showScanner]);

  const toggleFavorite = (placeId) => {
    setFavorites(prev => {
      const newFavorites = new Set(prev);
      if (newFavorites.has(placeId)) {
        newFavorites.delete(placeId);
      } else {
        newFavorites.add(placeId);
      }
      return newFavorites;
    });
  };

  const handleCardClick = (place) => {
    setShowDetail(place);
  };

  const handleHeartClick = (placeId) => {
    toggleFavorite(placeId);
  };

  const formatTime = (seconds) => {
    const hours = Math.floor(seconds / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    const secs = seconds % 60;
    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  };

  const BasicMode = () => (
    <div className="min-h-screen bg-gray-100 pb-20">
      <div className="bg-white px-4 py-3 flex items-center justify-between shadow-sm">
        <div className="flex items-center gap-2">
          <span className="text-lg font-medium">ì¡°ì•„ë¼ (5970)</span>
          <span className="text-gray-500">â–¼</span>
        </div>
        <div className="flex items-center gap-3">
          <span className="text-xs text-gray-600">{mode === 'basic' ? t.easyOff : t.easyOn}</span>
          <button 
            onClick={startCamera}
            className="bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700"
          >
            {t.qrAuth}
          </button>
        </div>
      </div>

      <div className="bg-white p-4 space-y-3">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={18} />
          <input 
            type="text" 
            placeholder={t.searchPlaceholder}
            className="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg text-sm"
          />
        </div>
      </div>

      <div className="px-4 mb-4">
        <div className="bg-red-500 rounded-lg overflow-hidden shadow-lg">
          <div className="p-4 text-center text-white">
            <div className="text-sm mb-2">{t.timeRemaining}</div>
            <div className="text-4xl font-bold mb-6">{formatTime(timeRemaining)}</div>
            
            <div className="bg-white text-black rounded-lg p-4 mx-2">
              <div className="text-xs text-gray-700 mb-1">[ì„œìš¸ì¤‘êµ¬íˆ¬ì–´íŒ¨ìŠ¤] ì„œìš¸ì¤‘êµ¬íˆ¬ì–´íŒ¨ìŠ¤ /</div>
              <div className="text-xs text-gray-700 mb-4">â˜…ì¶”ì„ë§ì´ íŠ¹ê°€â˜… ì„œìš¸ì¤‘êµ¬íˆ¬ì–´íŒ¨ìŠ¤ ê¸°ë³¸ê¶Œ(24ì‹œê°„)</div>
              
              <div className="flex justify-center mb-3">
                <div className="flex items-end">
                  {Array.from({length: 40}, (_, i) => (
                    <div 
                      key={i} 
                      className={`${i % 3 === 0 ? 'bg-black' : 'bg-white border-r border-black'} ${
                        i % 7 === 0 ? 'h-12' : i % 5 === 0 ? 'h-10' : 'h-8'
                      } w-1`}
                    />
                  ))}
                </div>
              </div>
              <div className="text-center text-xs text-gray-600 mb-2">4291300054942500</div>
              <div className="text-center text-sm font-medium">ì„±ì¸ 2</div>
            </div>
          </div>
        </div>
      </div>

      <div className="px-4 space-y-3 mb-4">
        <button 
          onClick={() => setShowDetail('favorites')}
          className="w-full bg-red-500 hover:bg-red-600 text-white py-4 rounded-lg font-medium flex items-center justify-center gap-2"
        >
          <User size={20} />
          {t.myFavorites} ({favorites.size}ê°œ ì°œí•¨)
        </button>
      </div>

      <div className="px-4 mb-4">
        <div className="relative overflow-hidden rounded-lg shadow-lg">
          <div 
            className="flex transition-transform duration-500 ease-in-out"
            style={{ transform: `translateX(-${currentBanner * 100}%)` }}
          >
            {bannerAds.map((banner, index) => (
              <div
                key={banner.id}
                className={`min-w-full bg-gradient-to-r ${banner.bgColor} p-4 flex items-center justify-between`}
              >
                <div className={banner.textColor}>
                  <h3 className="font-bold text-lg mb-1">{banner.title}</h3>
                  <p className="text-sm opacity-90">{banner.subtitle}</p>
                </div>
                <button 
                  onClick={() => handleBannerClick(banner)}
                  className="bg-white/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg text-sm hover:bg-white/30 transition-colors"
                >
                  {banner.type === 'survey' ? 'ì°¸ì—¬í•˜ê¸°' : 'ìì„¸íˆ'}
                </button>
              </div>
            ))}
          </div>
          
          <div className="absolute bottom-2 left-1/2 transform -translate-x-1/2 flex gap-2">
            {bannerAds.map((_, index) => (
              <button
                key={index}
                onClick={() => setCurrentBanner(index)}
                className={`w-2 h-2 rounded-full transition-colors ${
                  index === currentBanner ? 'bg-white' : 'bg-white/50'
                }`}
              />
            ))}
          </div>

          <button
            onClick={() => setCurrentBanner(prev => prev === 0 ? bannerAds.length - 1 : prev - 1)}
            className="absolute left-2 top-1/2 transform -translate-y-1/2 bg-black/20 text-white p-1 rounded-full hover:bg-black/40"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M15 18L9 12L15 6" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
          </button>
          <button
            onClick={() => setCurrentBanner(prev => (prev + 1) % bannerAds.length)}
            className="absolute right-2 top-1/2 transform -translate-y-1/2 bg-black/20 text-white p-1 rounded-full hover:bg-black/40"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M9 18L15 12L9 6" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
          </button>
        </div>
      </div>

      <div className="px-4">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-lg font-bold text-gray-900">{t.freeUse}</h2>
          <button className="bg-pink-500 text-white text-xs px-3 py-2 rounded-full">
            {t.viewFacilities}
          </button>
        </div>
        
        <div className="grid grid-cols-3 gap-3 mb-4">
          <div className="bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow relative">
            <div className="h-20 bg-gradient-to-br from-green-400 to-green-600 relative flex items-center justify-center">
              <div className="text-white text-2xl">ğŸ›ï¸</div>
              <div
                onMouseDown={() => handleHeartClick('palace')}
                onTouchStart={() => handleHeartClick('palace')}
                className="absolute top-1 right-1 text-lg z-10 cursor-pointer select-none"
                style={{ userSelect: 'none', WebkitUserSelect: 'none' }}
              >
                {favorites.has('palace') ? 'â¤ï¸' : 'ğŸ¤'}
              </div>
            </div>
            <div 
              onClick={() => handleCardClick('palace')}
              className="p-2 cursor-pointer"
            >
              <div className="text-xs font-medium text-gray-900 mb-1">{t.deoksugung}</div>
              <div className="text-xs text-pink-500 mb-1">{t.freeEntry}</div>
              <div className="text-xs text-gray-500 mb-2">193.7Km</div>
              <div className="flex items-center justify-between">
                <span className="text-xs text-gray-500"></span>
                <div className="flex gap-1">
                  <div className="p-1">
                    <Phone size={10} className="text-gray-400" />
                  </div>
                  <div className="p-1">
                    <Map size={10} className="text-gray-400" />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div className="bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow relative">
            <div className="h-20 bg-gradient-to-br from-purple-400 to-purple-600 relative flex items-center justify-center">
              <div className="text-white text-2xl">â˜•</div>
              <div
                onMouseDown={() => handleHeartClick('cafe')}
                onTouchStart={() => handleHeartClick('cafe')}
                className="absolute top-1 right-1 text-lg z-10 cursor-pointer select-none"
                style={{ userSelect: 'none', WebkitUserSelect: 'none' }}
              >
                {favorites.has('cafe') ? 'â¤ï¸' : 'ğŸ¤'}
              </div>
            </div>
            <div 
              onClick={() => handleCardClick('cafe')}
              className="p-2 cursor-pointer"
            >
              <div className="text-xs font-medium text-gray-900 mb-1">{t.haity}</div>
              <div className="text-xs text-pink-500 mb-1">{t.drinkService}</div>
              <div className="text-xs text-gray-500 mb-2">193.7Km</div>
              <div className="flex items-center justify-between">
                <span className="text-xs text-gray-500"></span>
                <div className="flex gap-1">
                  <div className="p-1">
                    <Phone size={10} className="text-gray-400" />
                  </div>
                  <div className="p-1">
                    <Map size={10} className="text-gray-400" />
                  </div>
                  <div className="p-1">
                    <MessageCircle size={10} className="text-gray-400" />
                  </div>
                  <div className="p-1">
                    <Phone size={10} className="text-gray-400" />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div className="bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow relative">
            <div className="h-20 bg-gradient-to-br from-orange-400 to-orange-600 relative flex items-center justify-center">
              <div className="text-white text-2xl">ğŸ¨</div>
              <div
                onMouseDown={() => handleHeartClick('workshop')}
                onTouchStart={() => handleHeartClick('workshop')}
                className="absolute top-1 right-1 text-lg z-10 cursor-pointer select-none"
                style={{ userSelect: 'none', WebkitUserSelect: 'none' }}
              >
                {favorites.has('workshop') ? 'â¤ï¸' : 'ğŸ¤'}
              </div>
            </div>
            <div 
              onClick={() => handleCardClick('workshop')}
              className="p-2 cursor-pointer"
            >
              <div className="text-xs font-medium text-gray-900 mb-1">{t.laughingDayWorkshop}</div>
              <div className="text-xs text-pink-500 mb-1">{t.travelTopperExperience}</div>
              <div className="text-xs text-gray-500 mb-2">193.9K</div>
              <div className="flex gap-1">
                <div className="p-1">
                  <Phone size={10} className="text-gray-400" />
                </div>
                <div className="p-1">
                  <Map size={10} className="text-gray-400" />
                </div>
                <div className="p-1">
                  <MessageCircle size={10} className="text-gray-400" />
                </div>
                <div className="p-1">
                  <Phone size={10} className="text-gray-400" />
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <button className="w-full border border-gray-300 py-3 rounded-lg text-center text-gray-700 bg-white hover:bg-gray-50">
          {t.seeAll}
        </button>

        <div className="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-4 mt-4 text-white">
          <h3 className="font-bold mb-3">{t.popularDestinations}</h3>
          <div className="space-y-2">
            {statsData.topDestinations.map((dest, index) => (
              <div key={index} className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <span className="font-bold">{index + 1}ìœ„</span>
                  <span>{dest.name}</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-16 h-2 bg-white/30 rounded-full overflow-hidden">
                    <div 
                      className="h-full bg-white rounded-full"
                      style={{ width: `${dest.percentage}%` }}
                    />
                  </div>
                  <span className="text-sm">{dest.percentage}%</span>
                </div>
              </div>
            ))}
          </div>
          <div className="text-xs opacity-80 mt-2">ì „ì›” ì´ìš© ê³ ê° ê¸°ì¤€</div>
        </div>
      </div>

      <div className="fixed bottom-0 left-0 right-0 max-w-sm mx-auto bg-white border-t border-gray-200 grid grid-cols-5">
        <button 
          onClick={() => setShowPopup(true)}
          className="flex flex-col items-center py-3 hover:bg-gray-50"
        >
          <Bell size={20} className="text-gray-600 mb-1" />
          <span className="text-xs text-gray-600">{t.announcement}</span>
        </button>
        <button 
          onClick={startCamera}
          className="flex flex-col items-center py-3 hover:bg-gray-50"
        >
          <User size={20} className="text-gray-600 mb-1" />
          <span className="text-xs text-gray-600">QRì¸ì¦</span>
        </button>
        <button 
          onClick={() => setShowDetail('courseRecommendation')}
          className="flex flex-col items-center py-3 hover:bg-gray-50"
        >
          <Map size={20} className="text-gray-600 mb-1" />
          <span className="text-xs text-gray-600">ì—¬í–‰ì½”ìŠ¤ì¶”ì²œ</span>
        </button>
        <button 
          onClick={() => setShowDetail('chatbot')}
          className="flex flex-col items-center py-3 hover:bg-gray-50"
        >
          <MessageCircle size={20} className="text-gray-600 mb-1" />
          <span className="text-xs text-gray-600">{t.chatbot}</span>
        </button>
        <button 
          onClick={() => setShowDetail('language')}
          className="flex flex-col items-center py-3 hover:bg-gray-50"
        >
          <Globe size={20} className="text-gray-600 mb-1" />
          <span className="text-xs text-gray-600">{t.language}</span>
        </button>
      </div>
    </div>
  );

  return (
    <div className="max-w-sm mx-auto bg-white relative">
      {mode === 'basic' ? <BasicMode /> : <div>Simple Mode</div>}

      {showPopup && (
        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-lg p-6 w-full max-w-sm">
            <h3 className="text-lg font-bold mb-4 text-center text-red-600">{t.importantNotice}</h3>
            <div className="space-y-3 text-sm text-gray-700 mb-6">
              <div>â€¢ ì¼ë¶€ ê°€ë§¹ì  ìš´ì˜ì‹œê°„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
              <div>â€¢ ì¹´í˜í—ˆë“¤&ë‚¨ì‚°ìƒ‰ë°© 2ì¸µ ì„ì‹œ íœ´ê´€ (12/20~12/25)</div>
              <div>â€¢ ë•ìˆ˜ê¶ ì•¼ê°„ ê°œë°© ì—°ì¥ ìš´ì˜ ì¤‘</div>
            </div>
            <div className="flex gap-3">
              <button 
                onClick={handleHidePopupToday}
                className="flex-1 bg-gray-400 text-white py-3 rounded-lg font-medium hover:bg-gray-500"
              >
                ì˜¤ëŠ˜ì€ ë‹¤ì‹œ ì•ˆë³´ê¸°
              </button>
              <button 
                onClick={() => setShowPopup(false)}
                className="flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700"
              >
                {t.confirm}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Survey Modal */}
      {showSurvey && (
        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-lg p-6 w-full max-w-sm">
            <div className="flex items-center justify-between mb-6">
              <h3 className="text-lg font-bold">íˆ¬ì–´íŒ¨ìŠ¤ ë§Œì¡±ë„ ì¡°ì‚¬</h3>
              <button onClick={() => setShowSurvey(false)} className="p-1">
                <X size={20} className="text-gray-600" />
              </button>
            </div>

            {surveyStep < surveyQuestions.length ? (
              <>
                {/* Progress Bar */}
                <div className="mb-6">
                  <div className="flex items-center justify-between text-sm text-gray-600 mb-2">
                    <span>ì§ˆë¬¸ {surveyStep + 1} / {surveyQuestions.length}</span>
                    <span>{Math.round(((surveyStep + 1) / surveyQuestions.length) * 100)}%</span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-2">
                    <div 
                      className="bg-indigo-500 h-2 rounded-full transition-all duration-300"
                      style={{ width: `${((surveyStep + 1) / surveyQuestions.length) * 100}%` }}
                    />
                  </div>
                </div>

                <div className="mb-6">
                  <h4 className="font-medium mb-4 text-center">
                    {surveyQuestions[surveyStep].question}
                  </h4>
                  
                  <div className="space-y-3">
                    {surveyQuestions[surveyStep].options.map((option, index) => (
                      <button
                        key={index}
                        onClick={() => {
                          const newAnswers = {
                            ...surveyAnswers,
                            [surveyQuestions[surveyStep].id]: option.value
                          };
                          setSurveyAnswers(newAnswers);
                          
                          if (surveyStep < surveyQuestions.length - 1) {
                            setSurveyStep(surveyStep + 1);
                          } else {
                            // ì„¤ë¬¸ ì™„ë£Œ
                            setSurveyStep(surveyQuestions.length);
                          }
                        }}
                        className="w-full p-4 text-left border border-gray-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-colors"
                      >
                        <div className="flex items-center gap-3">
                          {option.emoji && (
                            <span className="text-2xl">{option.emoji}</span>
                          )}
                          <span className="font-medium">{option.label}</span>
                        </div>
                      </button>
                    ))}
                  </div>
                </div>

                {surveyStep > 0 && (
                  <button
                    onClick={() => setSurveyStep(surveyStep - 1)}
                    className="w-full py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50"
                  >
                    ì´ì „ ì§ˆë¬¸
                  </button>
                )}
              </>
            ) : (
              /* ì„¤ë¬¸ ì™„ë£Œ */
              <div className="text-center py-8">
                <div className="text-6xl mb-4">ğŸ‰</div>
                <h3 className="text-xl font-bold mb-4">ê°ì‚¬í•©ë‹ˆë‹¤!</h3>
                <p className="text-gray-600 mb-6">
                  ì†Œì¤‘í•œ ì˜ê²¬ì„ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.<br/>
                  ë” ë‚˜ì€ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•´ í™œìš©í•˜ê² ìŠµë‹ˆë‹¤.
                </p>
                
                {/* ê°„ë‹¨í•œ ê²°ê³¼ í‘œì‹œ */}
                <div className="bg-indigo-50 rounded-lg p-4 mb-6">
                  <h4 className="font-medium mb-2">ğŸ“Š ì„¤ë¬¸ ê²°ê³¼</h4>
                  <div className="text-sm space-y-2">
                    {surveyAnswers.satisfaction && (
                      <div>ë§Œì¡±ë„: {surveyAnswers.satisfaction}/5</div>
                    )}
                    {surveyAnswers.recommendation && (
                      <div>ì¶”ì²œ ì˜í–¥: {
                        surveyAnswers.recommendation === 'yes' ? 'ì ê·¹ ì¶”ì²œ' :
                        surveyAnswers.recommendation === 'maybe' ? 'ì¡°ê±´ë¶€ ì¶”ì²œ' : 'ë¹„ì¶”ì²œ'
                      }</div>
                    )}
                  </div>
                </div>

                <div className="flex gap-3">
                  <button
                    onClick={() => {
                      setSurveyStep(0);
                      setSurveyAnswers({});
                    }}
                    className="flex-1 py-3 text-indigo-600 border border-indigo-300 rounded-lg hover:bg-indigo-50"
                  >
                    ë‹¤ì‹œ ì°¸ì—¬í•˜ê¸°
                  </button>
                  <button
                    onClick={() => setShowSurvey(false)}
                    className="flex-1 py-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600"
                  >
                    ì™„ë£Œ
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      )}

      {showDetail === 'courseRecommendation' && (
        <div className="fixed inset-0 bg-white z-50 overflow-y-auto">
          <div className="p-4">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-lg font-bold">AI ì—¬í–‰ì½”ìŠ¤ ì¶”ì²œ</h2>
              <button onClick={() => {
                setShowDetail(null);
                setCurrentQuestion(0);
                setUserAnswers({});
                setAiRecommendation(null);
                setIsAnalyzing(false);
              }} className="p-2">
                <X size={24} className="text-gray-600" />
              </button>
            </div>

            {!aiRecommendation ? (
              <>
                {!isAnalyzing ? (
                  <>
                    <div className="mb-6">
                      <div className="flex items-center justify-between text-sm text-gray-600 mb-2">
                        <span>ì§ˆë¬¸ {currentQuestion + 1} / {questionData.length}</span>
                        <span>{Math.round(((currentQuestion + 1) / questionData.length) * 100)}%</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2">
                        <div 
                          className="bg-blue-500 h-2 rounded-full transition-all duration-300"
                          style={{ width: `${((currentQuestion + 1) / questionData.length) * 100}%` }}
                        />
                      </div>
                    </div>

                    <div className="mb-8">
                      <h3 className="text-lg font-medium mb-6 text-center">
                        {questionData[currentQuestion].question}
                      </h3>
                      
                      <div className="space-y-3">
                        {questionData[currentQuestion].options.map((option, index) => (
                          <button
                            key={index}
                            onClick={() => {
                              const newAnswers = {
                                ...userAnswers,
                                [questionData[currentQuestion].id]: option
                              };
                              setUserAnswers(newAnswers);
                              
                              if (currentQuestion < questionData.length - 1) {
                                setCurrentQuestion(currentQuestion + 1);
                              } else {
                                setIsAnalyzing(true);
                                setTimeout(() => {
                                  const recommendation = generateAIRecommendation(newAnswers);
                                  setAiRecommendation(recommendation);
                                  setIsAnalyzing(false);
                                }, 2000);
                              }
                            }}
                            className="w-full p-4 text-left border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors"
                          >
                            <span className="font-medium">{option}</span>
                          </button>
                        ))}
                      </div>
                    </div>

                    {currentQuestion > 0 && (
                      <button
                        onClick={() => setCurrentQuestion(currentQuestion - 1)}
                        className="w-full py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50"
                      >
                        ì´ì „ ì§ˆë¬¸
                      </button>
                    )}
                  </>
                ) : (
                  <div className="text-center py-16">
                    <div className="animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"></div>
                    <h3 className="text-lg font-medium mb-2">AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</h3>
                    <p className="text-gray-600">ë‹¹ì‹ ì˜ ì·¨í–¥ì— ë§ëŠ” ìµœì ì˜ ì½”ìŠ¤ë¥¼ ì°¾ê³  ìˆì–´ìš”</p>
                  </div>
                )}
              </>
            ) : (
              <div className="space-y-6">
                <div className="bg-gradient-to-r from-green-400 to-blue-500 rounded-lg p-4 text-white">
                  <h3 className="font-bold text-lg mb-2">{aiRecommendation.title}</h3>
                  <p className="text-sm opacity-90">{aiRecommendation.description}</p>
                </div>

                <div className="space-y-4">
                  <h4 className="font-medium text-lg">ì¶”ì²œ ì¼ì •</h4>
                  {aiRecommendation.course.map((item, index) => (
                    <div key={index} className="bg-gray-50 rounded-lg p-4">
                      <div className="flex items-start gap-3">
                        <div className="bg-blue-500 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0">
                          {index + 1}
                        </div>
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-1">
                            <span className="font-medium text-blue-600">{item.time}</span>
                            <span className="text-sm text-gray-500">({item.duration})</span>
                          </div>
                          <h5 className="font-medium mb-1">{item.place}</h5>
                          <p className="text-sm text-gray-600">{item.activity}</p>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                  <h5 className="font-medium text-yellow-800 mb-2">ğŸ’¡ ì—¬í–‰ íŒ</h5>
                  <p className="text-sm text-yellow-700">{aiRecommendation.tip}</p>
                </div>

                <div className="flex gap-3">
                  <button
                    onClick={() => {
                      setCurrentQuestion(0);
                      setUserAnswers({});
                      setAiRecommendation(null);
                    }}
                    className="flex-1 py-3 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50"
                  >
                    ë‹¤ì‹œ ì¶”ì²œë°›ê¸°
                  </button>
                  <button
                    onClick={() => setShowDetail(null)}
                    className="flex-1 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                  >
                    ì¼ì • í™•ì¸ì™„ë£Œ
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      )}

      {showDetail === 'favorites' && (
        <div className="fixed inset-0 bg-white z-50 overflow-y-auto">
          <div className="p-4">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-lg font-bold">{t.favoritesTitle}</h2>
              <button onClick={() => setShowDetail(null)} className="p-2">
                <X size={24} className="text-gray-600" />
              </button>
            </div>

            <div className="space-y-4">
              {favorites.has('palace') && (
                <div className="bg-white rounded-lg shadow-sm p-4">
                  <div className="flex gap-4 mb-3">
                    <div className="w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-lg flex items-center justify-center relative">
                      <div className="text-white text-2xl">ğŸ›ï¸</div>
                      <div
                        onMouseDown={() => toggleFavorite('palace')}
                        onTouchStart={() => toggleFavorite('palace')}
                        className="absolute -top-1 -right-1 text-lg cursor-pointer"
                      >
                        â¤ï¸
                      </div>
                    </div>
                    <div className="flex-1">
                      <h3 className="font-medium text-gray-900 mb-1">{t.deoksugung}</h3>
                      <p className="text-sm text-pink-500 mb-1">{t.freeEntry}</p>
                      <p className="text-sm text-gray-500 mb-2">193.7Km</p>
                    </div>
                  </div>
                  <button className="w-full bg-pink-500 text-white py-2 rounded-lg text-sm font-medium">
                    {t.mobileAuth}
                  </button>
                </div>
              )}

              {favorites.has('cafe') && (
                <div className="bg-white rounded-lg shadow-sm p-4">
                  <div className="flex gap-4 mb-3">
                    <div className="w-20 h-20 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg flex items-center justify-center relative">
                      <div className="text-white text-2xl">â˜•</div>
                      <div
                        onMouseDown={() => toggleFavorite('cafe')}
                        onTouchStart={() => toggleFavorite('cafe')}
                        className="absolute -top-1 -right-1 text-lg cursor-pointer"
                      >
                        â¤ï¸
                      </div>
                    </div>
                    <div className="flex-1">
                      <h3 className="font-medium text-gray-900 mb-1">{t.haity}</h3>
                      <p className="text-sm text-pink-500 mb-1">{t.drinkService}</p>
                      <p className="text-sm text-gray-500 mb-2">193.7Km</p>
                    </div>
                  </div>
                  <button className="w-full bg-pink-500 text-white py-2 rounded-lg text-sm font-medium">
                    {t.mobileAuth}
                  </button>
                </div>
              )}

              {favorites.size === 0 && (
                <div className="text-center py-8 text-gray-500">
                  {t.noFavorites}
                </div>
              )}
            </div>
          </div>
        </div>
      )}

      {showScanner && (
        <div className="fixed inset-0 bg-black z-50 flex flex-col">
          <video 
            ref={videoRef}
            autoPlay 
            playsInline
            className="w-full h-full object-cover"
          />
          <div className="absolute inset-x-0 bottom-1/4 text-center text-white text-lg font-medium">
            QRì„ í”„ë ˆì„ ì•ˆì— ë§ì¶°ì£¼ì„¸ìš”
          </div>
          <button 
            onClick={stopCamera}
            className="absolute top-4 right-4 bg-transparent border border-white text-white px-4 py-2 rounded-lg flex items-center gap-2"
          >
            <X size={16} />
            ë‹«ê¸°
          </button>
        </div>
      )}

      {showResult && scanResult && (
        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-lg p-6 w-full max-w-sm">
            <h3 className="text-lg font-bold mb-4 text-center">ì¸ì¦ ì™„ë£Œ</h3>
            <div className="space-y-3 text-sm">
              <div>
                <span className="font-medium">ì¸ì¦ì‹œê°„:</span> {scanResult.time}
              </div>
              <div>
                <span className="font-medium">ì œê³µí˜œíƒ:</span> {scanResult.benefit}
              </div>
              <div>
                <span className="font-medium">ìœ ì˜ì‚¬í•­:</span> {scanResult.notice}
              </div>
            </div>
            <button 
              onClick={() => setShowResult(false)}
              className="w-full mt-6 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700"
            >
              í™•ì¸
            </button>
          </div>
        </div>
      )}

      {showDetail === 'chatbot' && (
        <div className="fixed inset-0 bg-white z-50 overflow-y-auto">
          <div className="p-4">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-lg font-bold">íˆ¬ì–´íŒ¨ìŠ¤ ë„ìš°ë¯¸</h2>
              <button onClick={() => setShowDetail(null)} className="p-2">
                <X size={24} className="text-gray-600" />
              </button>
            </div>

            <div className="space-y-4 mb-20">
              <div className="flex gap-3">
                <div className="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                  <span className="text-white text-sm">ğŸ¤–</span>
                </div>
                <div className="bg-gray-100 rounded-lg p-3 max-w-xs">
                  ì•ˆë…•í•˜ì„¸ìš”! íˆ¬ì–´íŒ¨ìŠ¤ ì´ìš©ì— ë„ì›€ì´ í•„ìš”í•˜ì‹œë©´ ì–¸ì œë“  ë¬¸ì˜í•´ì£¼ì„¸ìš”. ì–´ë–¤ ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?
                </div>
              </div>

              <div className="grid grid-cols-2 gap-2">
                <button className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-left hover:bg-blue-100">
                  ğŸ—ºï¸ ì¶”ì²œ ì½”ìŠ¤ ë¬¸ì˜
                </button>
                <button className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-left hover:bg-blue-100">
                  â° ìš´ì˜ì‹œê°„ í™•ì¸
                </button>
                <button className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-left hover:bg-blue-100">
                  ğŸ“± ì‚¬ìš©ë²• ì•ˆë‚´
                </button>
                <button className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-left hover:bg-blue-100">
                  ğŸ« í™˜ë¶ˆ/ì·¨ì†Œ ë¬¸ì˜
                </button>
              </div>
            </div>

            <div className="fixed bottom-0 left-0 right-0 max-w-sm mx-auto bg-white border-t p-4">
              <div className="flex gap-2">
                <input 
                  type="text" 
                  placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                  className="flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm"
                />
                <button className="bg-blue-500 text-white px-4 py-2 rounded-lg text-sm">
                  ì „ì†¡
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {showDetail === 'language' && (
        <div className="fixed inset-0 bg-white z-50 overflow-y-auto">
          <div className="p-4">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-lg font-bold">ì–¸ì–´ ì„ íƒ / Language Selection</h2>
              <button onClick={() => setShowDetail(null)} className="p-2">
                <X size={24} className="text-gray-600" />
              </button>
            </div>

            <div className="space-y-3">
              <button 
                onClick={() => {
                  setLanguage('ko');
                  setShowDetail(null);
                }}
                className={`w-full p-4 rounded-lg border text-left ${language === 'ko' ? 'bg-blue-50 border-blue-500' : 'bg-white border-gray-200'}`}
              >
                <div className="font-medium">í•œêµ­ì–´</div>
                <div className="text-sm text-gray-600">Korean</div>
              </button>

              <button 
                onClick={() => {
                  setLanguage('en');
                  setShowDetail(null);
                }}
                className={`w-full p-4 rounded-lg border text-left ${language === 'en' ? 'bg-blue-50 border-blue-500' : 'bg-white border-gray-200'}`}
              >
                <div className="font-medium">English</div>
                <div className="text-sm text-gray-600">ì˜ì–´</div>
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default TourPassApp;
